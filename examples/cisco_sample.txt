enable
configure terminal
vlan 10
 name USERS
 exit
vlan 20
 name SERVERS
 exit
vlan 30
 name VOICE
 exit
vlan 99
 name MGMT
 exit
router ospf 10
 router-id 10.10.99.1
 passive-interface default
 no passive-interface Vlan10
 no passive-interface Vlan20
 no passive-interface Vlan30
 no passive-interface Vlan99
 network 10.10.10.0 0.0.0.255 area 0
 network 10.10.20.0 0.0.0.255 area 0
 network 10.10.30.0 0.0.0.255 area 0
 network 10.10.99.0 0.0.0.255 area 0
 network 203.0.113.0 0.0.0.3 area 0
 exit
spanning-tree mode rstp
ip smtp server
ip ftp server enable
interface FastEthernet0/0
 description Uplink to ISP Router
 ip address 203.0.113.2 255.255.255.252
 exit
interface FastEthernet0/1
 switchport mode trunk
 switchport trunk allowed vlan 10,20,30,99
 description Trunk to Access-SW2
 exit
interface FastEthernet0/2
 description User access port (Floor 1)
 switchport access vlan 10
 exit
interface FastEthernet0/3
 description Server access port
 switchport access vlan 20
 exit
interface Vlan10
 description USERS gateway
 ip address 10.10.10.1 255.255.255.0
 exit
interface Vlan20
 description SERVERS gateway
 ip address 10.10.20.1 255.255.255.0
 exit
interface Vlan30
 description VOICE gateway
 ip address 10.10.30.1 255.255.255.0
 exit
interface Vlan99
 description MANAGEMENT gateway
 ip address 10.10.99.1 255.255.255.0
 exit
interface FastEthernet0/0
 exit
ip route 0.0.0.0 0.0.0.0 203.0.113.1
ip route 10.20.0.0 255.255.0.0 10.10.99.254
access-list 1 permit 10.10.0.0 0.0.255.255
access-list 2010 permit tcp 10.10.10.0 0.0.0.255 any eq 80
access-list 2010 permit tcp 10.10.10.0 0.0.0.255 any eq 443
access-list 2010 deny ip any any
ip nat inside source list 1 interface FastEthernet0/0
end
